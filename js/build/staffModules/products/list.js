define(["jquery","backbone","text!staffModules/products/tpl/list.tpl","models/product"],function(e,t,n,r){var i=t.Collection.extend({model:r});return t.View.extend({events:{"click .filter legend":"showFilter"},initialize:function(e){this.getData()},render:function(e,t){this.$el.html(_.template(e,t)).translate()},getData:function(){var t=this;Serenity.collections.Products=new i,this.collection=Serenity.collections.Products,e.ajax({url:"api/products.json",type:"GET",dataType:"JSON"}).done(function(e){t.collection.add(e),t.loadCategories()}).fail(function(e){Serenity.app.handleError(e)})},loadCategories:function(){var t=this;e.ajax({url:"api/categories.json",type:"GET",dataType:"JSON"}).done(function(e){t.render(n,{products:t.collection.toJSON(),categories:e})}).fail(function(e){Serenity.app.handleError(e)})},showFilter:function(e){this.$el.find(".filter").toggleClass("active")}})});